<!DOCTYPE html>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>File Manager</title>

<style type="text/css">
	#loading-wrap {
		position:fixed;
		height:100%;
		width:100%;
		overflow:hidden;
		top:0;
		left:0;
		display:block;
		background: white url(./images/wait30trans.gif) no-repeat center center;
		z-index:999;
	}
</style>

<!-- CSS dynamically added using 'config.options.theme' defined in config file -->
</head>
<body>
<div id="loading-wrap" data-bind="visible: loading"><!-- loading wrapper / removed when loaded --></div>
<div>
    <form id="uploader" method="post">
        <h1 data-bind="text: 'Current Folder: ' + currentPath()"></h1>
        <div id="uploadresponse"></div>
        <button type="button" class="btn" data-bind="click: goLevelUp, visible: currentPath() !== config.options.fileRoot || currentView() === 'details'"><span class="glyphicon glyphicon-level-up"></span></button>
        <button type="button" class="btn" data-bind="click: goHome, visible: notHome"><span class="glyphicon glyphicon-home"></span></button>
        <!--<input id="mode" name="mode" type="hidden" value="add"/>-->
        <!--<input id="currentpath" name="currentpath" type="hidden"/>-->
        <!--<div id="file-input-container">-->
            <!--<div id="alt-fileinput">-->
                <!--<input id="filepath" name="filepath" type="text"/><button id="browse" name="browse" type="button" value="Browse"></button>-->
            <!--</div>-->
            <!--<input id="newfile" name="newfile" type="file"/>-->
        <!--</div>-->
        <button type="button" class="btn" data-bind="click: function (){currentView('uploads');}, visible: function () {hasCapability('upload')}"><span class="glyphicon glyphicon-upload"> Upload</span></button>
        <button type="button" class="btn" data-bind="click: createFolder"><span class="glyphicon glyphicon-folder-open"></span> New Folder</button>
        <button type="button" data-bind="title: language.list_view, click: switchViews, css: viewButtonClass" class="btn"></button>
    </form>

    <div id="splitter">
        <div id="filetree">
        </div>
        <div id="fileinfo">

            <div class="container">
                <div class="row">
                    <div data-bind="template: {name: templateName, afterRender: afterRender}">
                    </div>

                </div>
            </div>
            </div>
    </div>

<div id="footer">
<form name="search" id="search" method="get">
		<div>
			<input type="text" value="" name="q" id="q" />
			<a id="reset" href="#" class="q-reset"></a>
			<span class="q-inactive"></span>
		</div> 
</form>
    <a data-bind="attr: {href: config.url}" id="link-to-project"></a>
    <p data-bind="text: 'v:' + config.version" style="float: right; margin: 1em"></p>
    <div id="folder-info"></div>

</div>

    <ul id="itemOptions" class="contextMenu">
        <li class="select"><a href="#select"></a></li>
        <li class="download"><a href="#download"></a></li>
        <li class="rename"><a href="#rename"></a></li>
        <li class="move"><a href="#move"></a></li>
        <li class="replace"><a href="#replace"></a></li>
        <li class="delete separator"><a href="#delete"></a></li>
    </ul>

    <script type="text/html" id="uploads-template">
    <p> Let us upload some filuz :)</p>
        <form action="/file-upload"
          class="dropzone"
          id="my-awesome-dropzone"></form>
    </script>

    <script type="text/html" id="grid-template">
        <ul id="contents" class="grid" data-bind="foreach: {data: currentFolder, as: 'item'}">
            <li class="cap_select cap_download cap_rename cap_delete cap_replace" data-bind="click: $root.goToItem">
                <div class="clip"><img width="64" data-bind="attr: {src: getIconUrl, alt: getIconUrl, dataPath: getIconUrl}"/>
                </div>
                <p data-bind="text: item.filename"></p>
            </li>
        </ul>
    </script>

    <script type="text/html" id="list-template">
        <table class="table">
            <thead>
            <tr>
                <th>{{$root.language.name}}</th>
                <th>{{$root.language.dimensions}}</th>
                <th>{{$root.language.size}}</th>
                <th>{{$root.language.modified}}</th>
            </tr>
            </thead>
            <tbody data-bind="foreach: {data: currentFolder, as: 'item'}">
            <tr class="cap_select cap_download cap_rename cap_delete cap_replace" data-bind="click: $root.goToItem">
                <td><span data-bind="css: item.isDirectory() ? 'glyphicon glyphicon-folder-close' : 'glyphicon glyphicon-file'">  {{item.filename}}</span> </td>
                <td>{{item.properties().height}}x{{item.properties().width}}</td>
                <td>{{item.properties().size}}</td>
                <td>{{item.properties().dateModified}}</td>
            </tr>
            </tbody>
        </table>
    </script>

    <script type="text/html" id="details-template">
        <div class="center-block" data-bind="with: currentItem">
            <div data-bind="template: {name: templateName}"></div>
            <div class="center-block">
                <button class="btn" data-bind="visible: function () {$root.hasCapability('select')}">Select</button>
                <button class="btn" data-bind="click: download, visible: function () {$root.hasCapability('download')}">Download</button>
                <button class="btn" data-bind="click: rename, visible: function () {$root.hasCapability('rename')}">Rename</button>
                <button class="btn" data-bind="click: move, visible: function () {$root.hasCapability('move')}">Move</button>
                <button class="btn" data-bind="click: removeMe, visible: function () {$root.hasCapability('move');}">Delete</button>
                <button class="btn" data-bind="click: replaceMe, visible: function () {$root.hasCapability('replace')}" id="replaceMe">Replace</button>
                <form id="my-awesome-dropzone2" style="display: none;" class="dropzone"></form>
                <h1 class="h1 center-block">{{filename}}</h1>
                <!--<div id="tools"></div>-->
            </div>
            <dl>
                <dt>Dimensions</dt>
                <dd>{{properties().height}}x{{properties().width}}</dd>
                <dt>Created</dt>
                <dd>{{properties().dateCreated}}</dd>
                <dt>Modified</dt>
                <dd>{{properties().dateModified}}</dd>
                <dt>Size</dt>
                <dd>{{properties().size}}</dd>
            </dl>
        </div>
    </script>

    <script type="text/html" id="image-template">
        <img id="detailImage" data-bind="attr: {src: getDownloadUrl, alt: getDownloadUrl}, visible: isImageFile" class="img-thumbnail center-block">
    </script>

    <script type="text/html" id="video-player-template">
        <video data-bind="attr: {width: config.videos.videosPlayerWidth, height: config.videos.videosPlayerHeight, src: getDownloadUrl}" controls='controls'>
            <img data-bind="attr: {src: getPreviewUrl}" />
        </video>
    </script>

    <script type="text/html" id="audio-player-template">
        <audio data-bind="attr: {src: getDownloadUrl}" controls='controls'>
            <img data-bind="attr: {src: getPreviewUrl}" />
        </audio>
    </script>

    <script type="text/html" id="pdf-viewer-template">
        <iframe id='fm-pdf-viewer' data-bind="attr: {src: 'scripts/ViewerJS/index.html#' + getDownloadUrl(), width: config.pdfs.pdfsReaderWidth
            height: config.pdfs.pdfsReaderHeight}"
            allowfullscreen webkitallowfullscreen></iframe>
    </script>

    <!--<script type="text/javascript" src="scripts/jquery-1.11.3.min.js"></script>-->
<!--<script type="text/javascript" src="scripts/jquery-browser.js"></script>-->
<!--<script type="text/javascript" src="scripts/jquery.form-3.24.js"></script>-->
<!--<script type="text/javascript" src="scripts/jquery.splitter/jquery.splitter-1.5.1.js"></script>-->
<!--<script type="text/javascript" src="scripts/jquery.filetree/jqueryFileTree.js"></script>-->
<!--<script type="text/javascript" src="scripts/jquery.contextmenu/jquery.contextMenu-1.01.js"></script>-->
<!--<script type="text/javascript" src="scripts/jquery.impromptu-3.2.min.js"></script>-->
<!--<script type="text/javascript" src="scripts/jquery.tablesorter-2.7.2.min.js"></script>-->
<script type="text/javascript" data-main="scripts/filemanager.js" src="node_modules/requirejs/require.js"></script>
</div>
</body>
</html>